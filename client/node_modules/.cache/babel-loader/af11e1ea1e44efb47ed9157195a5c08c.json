{"ast":null,"code":"var _jsxFileName = \"/Users/singco/dev/projects/S07P12C104/client/src/pages/Index/Redirect.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport { useNavigate, useSearchParams, useLocation } from 'react-router-dom';\nimport Loading from '../../components/Common/Loading/Loading';\nimport * as authApi from '../../api/auth';\nimport { setRefreshToken } from '../../storage/Cookie';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Redirect = () => {\n  _s();\n\n  const [searchParams] = useSearchParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const kakaoToken = searchParams.get('code');\n  const googleToken = new URLSearchParams(location.hash).get('id_token');\n  useEffect(() => {\n    const login = async () => {\n      if (!kakaoToken && !googleToken) {\n        alert('로그인에 실패했습니다');\n        navigate('/');\n      }\n\n      let body = {};\n\n      if (kakaoToken) {\n        body = {\n          loginType: 'Kakao',\n          token: kakaoToken\n        };\n      } else if (googleToken) {\n        body = {\n          loginType: 'Google',\n          token: googleToken\n        };\n      }\n\n      try {\n        const res = await authApi.login(body);\n\n        if (res.result === 'success') {\n          // todo: 클라이언트 로그인 로직 구현 필요\n          setRefreshToken(res.refresh_token);\n          const {\n            accessToken\n          } = res.data; // API 요청하는 콜마다 헤더에 accessToken 담아 보내도록 설정\n\n          API.defaults.headers.common['Authorization'] = `Bearer ${accessToken}`;\n          navigate('/main');\n        } else if (res.result === 'needToJoin') {\n          // todo :약관 동의 및 회원 가입 진행 페이지로 진입\n          navigate('/join/index');\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    login();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      children: \"\\uB85C\\uB529\\uC911\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Redirect, \"v8+2GaRQ4ZjJZR3X4AB+ba/K7IU=\", false, function () {\n  return [useSearchParams, useLocation, useNavigate];\n});\n\n_c = Redirect;\nexport default Redirect;\n\nvar _c;\n\n$RefreshReg$(_c, \"Redirect\");","map":{"version":3,"names":["React","useEffect","useNavigate","useSearchParams","useLocation","Loading","authApi","setRefreshToken","Redirect","searchParams","location","navigate","kakaoToken","get","googleToken","URLSearchParams","hash","login","alert","body","loginType","token","res","result","refresh_token","accessToken","data","API","defaults","headers","common","err","console","log"],"sources":["/Users/singco/dev/projects/S07P12C104/client/src/pages/Index/Redirect.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { useNavigate, useSearchParams, useLocation } from 'react-router-dom';\n\nimport Loading from '../../components/Common/Loading/Loading';\nimport * as authApi from '../../api/auth';\nimport { setRefreshToken } from '../../storage/Cookie';\n\nconst Redirect = () => {\n\tconst [searchParams] = useSearchParams();\n\tconst location = useLocation();\n\tconst navigate = useNavigate();\n\tconst kakaoToken = searchParams.get('code');\n\tconst googleToken = new URLSearchParams(location.hash).get('id_token');\n\n\tuseEffect(() => {\n\t\tconst login = async () => {\n\t\t\tif (!kakaoToken && !googleToken) {\n\t\t\t\talert('로그인에 실패했습니다');\n\t\t\t\tnavigate('/');\n\t\t\t}\n\t\t\tlet body = {};\n\t\t\tif (kakaoToken) {\n\t\t\t\tbody = {\n\t\t\t\t\tloginType: 'Kakao',\n\t\t\t\t\ttoken: kakaoToken,\n\t\t\t\t};\n\t\t\t} else if (googleToken) {\n\t\t\t\tbody = {\n\t\t\t\t\tloginType: 'Google',\n\t\t\t\t\ttoken: googleToken,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst res = await authApi.login(body);\n\t\t\t\tif (res.result === 'success') {\n\t\t\t\t\t// todo: 클라이언트 로그인 로직 구현 필요\n\t\t\t\t\tsetRefreshToken(res.refresh_token);\n\t\t\t\t\tconst { accessToken } = res.data;\n\n\t\t\t\t\t// API 요청하는 콜마다 헤더에 accessToken 담아 보내도록 설정\n\t\t\t\t\tAPI.defaults.headers.common['Authorization'] = `Bearer ${accessToken}`;\n\n\t\t\t\t\tnavigate('/main');\n\t\t\t\t} else if (res.result === 'needToJoin') {\n\t\t\t\t\t// todo :약관 동의 및 회원 가입 진행 페이지로 진입\n\t\t\t\t\tnavigate('/join/index');\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t}\n\t\t};\n\t\tlogin();\n\t}, []);\n\n\treturn (\n\t\t<>\n\t\t\t<Loading />\n\t\t\t<span>로딩중</span>\n\t\t</>\n\t);\n};\nexport default Redirect;\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,WAAT,EAAsBC,eAAtB,EAAuCC,WAAvC,QAA0D,kBAA1D;AAEA,OAAOC,OAAP,MAAoB,yCAApB;AACA,OAAO,KAAKC,OAAZ,MAAyB,gBAAzB;AACA,SAASC,eAAT,QAAgC,sBAAhC;;;;AAEA,MAAMC,QAAQ,GAAG,MAAM;EAAA;;EACtB,MAAM,CAACC,YAAD,IAAiBN,eAAe,EAAtC;EACA,MAAMO,QAAQ,GAAGN,WAAW,EAA5B;EACA,MAAMO,QAAQ,GAAGT,WAAW,EAA5B;EACA,MAAMU,UAAU,GAAGH,YAAY,CAACI,GAAb,CAAiB,MAAjB,CAAnB;EACA,MAAMC,WAAW,GAAG,IAAIC,eAAJ,CAAoBL,QAAQ,CAACM,IAA7B,EAAmCH,GAAnC,CAAuC,UAAvC,CAApB;EAEAZ,SAAS,CAAC,MAAM;IACf,MAAMgB,KAAK,GAAG,YAAY;MACzB,IAAI,CAACL,UAAD,IAAe,CAACE,WAApB,EAAiC;QAChCI,KAAK,CAAC,aAAD,CAAL;QACAP,QAAQ,CAAC,GAAD,CAAR;MACA;;MACD,IAAIQ,IAAI,GAAG,EAAX;;MACA,IAAIP,UAAJ,EAAgB;QACfO,IAAI,GAAG;UACNC,SAAS,EAAE,OADL;UAENC,KAAK,EAAET;QAFD,CAAP;MAIA,CALD,MAKO,IAAIE,WAAJ,EAAiB;QACvBK,IAAI,GAAG;UACNC,SAAS,EAAE,QADL;UAENC,KAAK,EAAEP;QAFD,CAAP;MAIA;;MAED,IAAI;QACH,MAAMQ,GAAG,GAAG,MAAMhB,OAAO,CAACW,KAAR,CAAcE,IAAd,CAAlB;;QACA,IAAIG,GAAG,CAACC,MAAJ,KAAe,SAAnB,EAA8B;UAC7B;UACAhB,eAAe,CAACe,GAAG,CAACE,aAAL,CAAf;UACA,MAAM;YAAEC;UAAF,IAAkBH,GAAG,CAACI,IAA5B,CAH6B,CAK7B;;UACAC,GAAG,CAACC,QAAJ,CAAaC,OAAb,CAAqBC,MAArB,CAA4B,eAA5B,IAAgD,UAASL,WAAY,EAArE;UAEAd,QAAQ,CAAC,OAAD,CAAR;QACA,CATD,MASO,IAAIW,GAAG,CAACC,MAAJ,KAAe,YAAnB,EAAiC;UACvC;UACAZ,QAAQ,CAAC,aAAD,CAAR;QACA;MACD,CAfD,CAeE,OAAOoB,GAAP,EAAY;QACbC,OAAO,CAACC,GAAR,CAAYF,GAAZ;MACA;IACD,CApCD;;IAqCAd,KAAK;EACL,CAvCQ,EAuCN,EAvCM,CAAT;EAyCA,oBACC;IAAA,wBACC,QAAC,OAAD;MAAA;MAAA;MAAA;IAAA,QADD,eAEC;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAFD;EAAA,gBADD;AAMA,CAtDD;;GAAMT,Q;UACkBL,e,EACNC,W,EACAF,W;;;KAHZM,Q;AAuDN,eAAeA,QAAf"},"metadata":{},"sourceType":"module"}