{"ast":null,"code":"import _regeneratorRuntime from\"/Users/singco/dev/projects/S07P12C104/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/singco/dev/projects/S07P12C104/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/singco/dev/projects/S07P12C104/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/singco/dev/projects/S07P12C104/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import Button from'../../components/Common/Button/Button';import TopNavigation from'../../components/Common/TopNavigation/TopNavigation';import API from'../../api';import{setRefreshToken}from'../../storage/Cookie';import*as authApi from'../../api/auth';import{useUserDispatch,useUserState}from'../../context/User/UserContext';import{setLogin}from'../../context/User/UserTypes';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var JoinTown=function JoinTown(_ref){var info=_ref.info;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),location=_useState2[0],setLocation=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),readyState=_useState4[0],setReadyState=_useState4[1];var navigate=useNavigate();var _useUserState=useUserState(),loginedUserId=_useUserState.loginedUserId;var dispatch=useUserDispatch();var signupHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var body,res,_res$accessToken,userId,accessToken;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;body=_objectSpread(_objectSpread({},info),{},{userId:loginedUserId,region:location});_context.next=4;return authApi.signup(body);case 4:res=_context.sent;_res$accessToken=res.accessToken,userId=_res$accessToken.userId,accessToken=_res$accessToken.accessToken;setRefreshToken(res.refreshToken);dispatch(setLogin(userId));API.defaults.headers.common['Authorization']=\"Bearer \".concat(accessToken);navigate('/main');_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);throw _context.t0;case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return function signupHandler(){return _ref2.apply(this,arguments);};}();useEffect(function(){if(location)setReadyState(true);},[location]);var getLocation=function getLocation(){window.navigator.geolocation.getCurrentPosition(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(data){var _data$coords,latitude,longitude,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_data$coords=data.coords,latitude=_data$coords.latitude,longitude=_data$coords.longitude;_context2.next=3;return axios.get(\"https://dapi.kakao.com/v2/local/geo/coord2address.json?x=\".concat(longitude,\"&y=\").concat(latitude),{headers:{Authorization:\"KakaoAK \".concat(process.env.REACT_APP_KAKAO_REST_API_KEY)}});case 3:res=_context2.sent;setLocation(res.data.documents[0].address.region_1depth_name+' '+res.data.documents[0].address.region_2depth_name+' '+res.data.documents[0].address.region_3depth_name);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref3.apply(this,arguments);};}());};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TopNavigation,{backClick:true,onBackClick:function onBackClick(){navigate(-1);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper\",style:{padding:'30px',width:'100%',height:'100%',position:'relative'},children:[/*#__PURE__*/_jsx(\"h2\",{className:\"fs-24 fw-700\",style:{textAlign:'center',paddingBottom:30},children:\"\\uB0B4 \\uB3D9\\uB124 \\uB4F1\\uB85D\\uD558\\uAE30\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',justifyContent:'space-around',alignItems:'center',border:'2px solid black',borderRadius:21,padding:5,height:'50%'},children:[location?/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsx(\"span\",{className:\"fs-22 fw-700\",style:{textAlign:'center'},children:\"\\uD604\\uC7AC\"}),/*#__PURE__*/_jsx(\"span\",{className:\"fs-22 fw-700\",style:{textAlign:'center'},children:location}),/*#__PURE__*/_jsx(\"span\",{className:\"fs-22 fw-700\",style:{textAlign:'center'},children:\"\\uC785\\uB2C8\\uB2E4\"})]}):/*#__PURE__*/_jsx(\"span\",{className:\"fs-22 fw-700\",style:{textAlign:'center'},children:\"\\uC704\\uCE58\\uB97C \\uD655\\uC778\\uD574\\uC8FC\\uC138\\uC694\"}),/*#__PURE__*/_jsx(Button,{style:{width:'80%'},type:\"outlined\",label:\"\\uB0B4 \\uC704\\uCE58 \\uD655\\uC778\\uD558\\uAE30\",onClick:getLocation})]}),/*#__PURE__*/_jsx(Button,{style:{position:'absolute',bottom:0,width:'calc(100% - 60px)',marginBottom:50},type:readyState?'active':'disabled',label:\"\\uD68C\\uC6D0\\uAC00\\uC785 \\uD558\\uAE30\",onClick:function onClick(){return signupHandler();}})]})]});};export default JoinTown;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","axios","Button","TopNavigation","API","setRefreshToken","authApi","useUserDispatch","useUserState","setLogin","JoinTown","info","location","setLocation","readyState","setReadyState","navigate","loginedUserId","dispatch","signupHandler","body","userId","region","signup","res","accessToken","refreshToken","defaults","headers","common","getLocation","window","navigator","geolocation","getCurrentPosition","data","coords","latitude","longitude","get","Authorization","process","env","REACT_APP_KAKAO_REST_API_KEY","documents","address","region_1depth_name","region_2depth_name","region_3depth_name","padding","width","height","position","textAlign","paddingBottom","display","flexDirection","justifyContent","alignItems","border","borderRadius","bottom","marginBottom"],"sources":["/Users/singco/dev/projects/S07P12C104/client/src/pages/Join/JoinTown.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\n\nimport Button from '../../components/Common/Button/Button';\nimport TopNavigation from '../../components/Common/TopNavigation/TopNavigation';\nimport API from '../../api';\nimport { setRefreshToken } from '../../storage/Cookie';\nimport * as authApi from '../../api/auth';\nimport { useUserDispatch, useUserState } from '../../context/User/UserContext';\nimport { setLogin } from '../../context/User/UserTypes';\n\nconst JoinTown = ({ info }) => {\n\tconst [location, setLocation] = useState(null);\n\tconst [readyState, setReadyState] = useState(false);\n\tconst navigate = useNavigate();\n\tlet { loginedUserId } = useUserState();\n\tconst dispatch = useUserDispatch();\n\n\tconst signupHandler = async () => {\n\t\ttry {\n\t\t\tconst body = {\n\t\t\t\t...info,\n\t\t\t\tuserId: loginedUserId,\n\t\t\t\tregion: location,\n\t\t\t};\n\n\t\t\tconst res = await authApi.signup(body);\n\t\t\tconst { userId, accessToken } = res.accessToken;\n\n\t\t\tsetRefreshToken(res.refreshToken);\n\t\t\tdispatch(setLogin(userId));\n\t\t\tAPI.defaults.headers.common['Authorization'] = `Bearer ${accessToken}`;\n\t\t\tnavigate('/main');\n\t\t} catch (err) {\n\t\t\tthrow err;\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tif (location) setReadyState(true);\n\t}, [location]);\n\tconst getLocation = () => {\n\t\twindow.navigator.geolocation.getCurrentPosition(async data => {\n\t\t\tconst { latitude, longitude } = data.coords;\n\t\t\tconst res = await axios.get(\n\t\t\t\t`https://dapi.kakao.com/v2/local/geo/coord2address.json?x=${longitude}&y=${latitude}`,\n\t\t\t\t{\n\t\t\t\t\theaders: {\n\t\t\t\t\t\tAuthorization: `KakaoAK ${process.env.REACT_APP_KAKAO_REST_API_KEY}`,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t\tsetLocation(\n\t\t\t\tres.data.documents[0].address.region_1depth_name +\n\t\t\t\t\t' ' +\n\t\t\t\t\tres.data.documents[0].address.region_2depth_name +\n\t\t\t\t\t' ' +\n\t\t\t\t\tres.data.documents[0].address.region_3depth_name,\n\t\t\t);\n\t\t});\n\t};\n\treturn (\n\t\t<>\n\t\t\t<TopNavigation\n\t\t\t\tbackClick\n\t\t\t\tonBackClick={() => {\n\t\t\t\t\tnavigate(-1);\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tclassName=\"wrapper\"\n\t\t\t\tstyle={{\n\t\t\t\t\tpadding: '30px',\n\t\t\t\t\twidth: '100%',\n\t\t\t\t\theight: '100%',\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<h2 className=\"fs-24 fw-700\" style={{ textAlign: 'center', paddingBottom: 30 }}>\n\t\t\t\t\t내 동네 등록하기\n\t\t\t\t</h2>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\tflexDirection: 'column',\n\t\t\t\t\t\tjustifyContent: 'space-around',\n\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\tborder: '2px solid black',\n\t\t\t\t\t\tborderRadius: 21,\n\t\t\t\t\t\tpadding: 5,\n\t\t\t\t\t\theight: '50%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{location ? (\n\t\t\t\t\t\t<div style={{ display: 'flex', flexDirection: 'column' }}>\n\t\t\t\t\t\t\t<span className=\"fs-22 fw-700\" style={{ textAlign: 'center' }}>\n\t\t\t\t\t\t\t\t현재\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span className=\"fs-22 fw-700\" style={{ textAlign: 'center' }}>\n\t\t\t\t\t\t\t\t{location}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span className=\"fs-22 fw-700\" style={{ textAlign: 'center' }}>\n\t\t\t\t\t\t\t\t입니다\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<span className=\"fs-22 fw-700\" style={{ textAlign: 'center' }}>\n\t\t\t\t\t\t\t위치를 확인해주세요\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tstyle={{ width: '80%' }}\n\t\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\t\tlabel=\"내 위치 확인하기\"\n\t\t\t\t\t\tonClick={getLocation}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<Button\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\tbottom: 0,\n\t\t\t\t\t\twidth: 'calc(100% - 60px)',\n\t\t\t\t\t\tmarginBottom: 50,\n\t\t\t\t\t}}\n\t\t\t\t\ttype={readyState ? 'active' : 'disabled'}\n\t\t\t\t\tlabel=\"회원가입 하기\"\n\t\t\t\t\tonClick={() => signupHandler()}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</>\n\t);\n};\n\nexport default JoinTown;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}